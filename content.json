{"meta":{"title":"Hexo博客","subtitle":"","description":"","author":"Yonggang Shi","url":"http://blog.loveyx815.cn","root":"/"},"pages":[{"title":"","date":"2020-04-08T02:56:22.242Z","updated":"2020-04-08T02:56:22.242Z","comments":false,"path":"categories/index.html","permalink":"http://blog.loveyx815.cn/categories/index.html","excerpt":"","text":""},{"title":"","date":"2020-04-08T02:55:48.126Z","updated":"2020-04-08T02:55:48.126Z","comments":false,"path":"tags/index.html","permalink":"http://blog.loveyx815.cn/tags/index.html","excerpt":"","text":""}],"posts":[{"title":"Hello World","slug":"hello-world","date":"2020-04-08T02:27:31.553Z","updated":"2020-04-08T02:27:31.553Z","comments":true,"path":"2020/04/08/hello-world/","link":"","permalink":"http://blog.loveyx815.cn/2020/04/08/hello-world/","excerpt":"","text":"Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new \"My New Post\" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment","categories":[],"tags":[]},{"title":"test my blog","slug":"南京SQL优化实战","date":"2020-04-06T16:00:00.000Z","updated":"2020-04-08T03:25:23.627Z","comments":true,"path":"2020/04/07/南京SQL优化实战/","link":"","permalink":"http://blog.loveyx815.cn/2020/04/07/%E5%8D%97%E4%BA%ACSQL%E4%BC%98%E5%8C%96%E5%AE%9E%E6%88%98/","excerpt":"","text":"[TOC] 一、理论部分 abase执行SQL语句时，首先通过语法分析模块（词法分析、语法分析(语法树)、语义分析（查询树）），然后通过查询优化器进行逻辑优化和物理优化，生成计划树，就是执行计划。 逻辑优化: 是基于规则的优化，对SQL进行重写。比如谓词下推，连接顺序交换等。 物理优化：是基于代价的优化，数据库建立了各种代价模型，对各种物理路径进行代价的评估，选择一条代价相对较低的执行。物理路径包括扫描路径、连接路径等。 代价计算: 代价的计算需要用到统计信息和选择率。统计信息记录了表内数据的抽样信息，定期进行统计。根据统计信息，数据库可以计算出一个约束条件可以过滤掉多少数据，计算出选择率。根据选择率可以得到各种物理路径的代价。 连接路径: 嵌套循环连接、哈希连接、归并连接。 二、执行计划查看命令语法 explain[(option[,…])]explain [analyze][verbose]statement可选的option选项有： analyze[boolean]：得到statement的真实运行时间。默认是false verbose[boolean]：得到statement语句的执行计划和执行计划中的每个节点的详细信息。默认为false costs[boolean]：得到计划中每个接地哪的cost，rows，width的估算值，默认为true buffers[boolean]：analyze出现时可选。缓存的使用情况共享缓存(shared blocks)的hit，read，dirtied，written数值本地缓存(local blocks)的hit，read，dirtied,written数值临时快(temp blocks)的read,written数值 timing[boolean]：analyze出现时可选。显示每个节点的启动时间和总时间花费。默认true format{text|xml|json|yaml}：指定执行计划的输出格式text：默认值。以行为单位，显示每个结点的计划信息，以缩进格式表示子节点的计划信息。buffers参数时的文本格式，只输出非零值xml：xml格式json：json格式yaml：以yaml格式显示执行计划 常用组合 一般查询explain analyze select … ; 查询缓存及详细信息explain (analyze,verbose,buffers) select … ; 针对更新插入删除的执行计划查询begin;explain analyze insert/update/delete … ;rollback; 三、具体优化案例3.1查询计划解读关键字 cost:重要的指标。cost=0.00..16.11有两个部分，启动时间=0.00 和总时间=16.11。单位是毫秒。这个指标也只是预测值。启动时间也有解释为找到符合条件的第一行所花的时间。 rows:返回的行数，如果执行vacuum和analyze那么返回的结果更加接近实际值 width:查询结果所有字段的总宽度，并非关键指标。 actual time：实际花费的时间。 loops：循环的次数 buffers：缓冲命中数 output： 输出的字段名 planning time: 生成执行计划时间 execution time：执行执行计划时间 阅读顺序 嵌套层次最深的，最先执行 同样嵌套深度的，从上到下，先予执行 每一步的cost包括上一步 节点 Seq Scan: 表扫描 Index Scan：索引扫描(读取索引块，然后读取数据文件) Index Only Scan：索引只读扫描(只读取索引文件，根据映射文件获取数据) Nested [(type)] Loop：嵌套循环连接。type可能是Inner，left，right，full，semi，anti。inner的可以显示省略 Merge[(type)] Join 归并连接。type同上 Hash[(type)] Join：哈希连接。type同上 3.2现场具体SQL查看3.2.1第一个SQL，砍掉所有无用部分set PGPASSWORD=tusc@6789#JKLE:\\thunisoft\\arterybase\\3.6\\bin\\psql -Usa -h172.23.21.124 -p6543 -dzfxt_zf 12345678910111213explain analyze WITH xgr AS ( SELECT xyr.c_id_ajxx, string_agg((xyr.c_xyrxm), &#39;,&#39;) AS xyr FROM db_yw.t_jc_gaxyr xyr INNER JOIN (SELECT DISTINCT c_ajid FROM db_yw.t_sacw_cwjbxx_copy) jb ON jb.c_ajid &#x3D; xyr.c_id_ajxx GROUP BY xyr.c_id_ajxx) SELECT count(*) FROM (SELECT aj.c_id C_AJID, MAX(aj.c_ajmc) C_AJMC, MAX(aj.c_ajbh) c_ajbh, MAX(xgr.xyr) C_XGR, MAX(aj.d_lasj) D_LARQ, MAX(fbxx.c_sydw) C_YSDW FROM db_yw.t_sacw_cwjbxx_copy jbxx INNER JOIN db_yw.t_jc_gaaj aj ON jbxx.c_ajid &#x3D; aj.c_id INNER JOIN db_yw.t_sacw_cwfbxx_copy fbxx ON jbxx.c_id&#x3D;fbxx.c_cwxx_id LEFT JOIN xgr ON jbxx.c_ajid &#x3D; xgr.c_id_ajxx WHERE fbxx.c_ysdw IN (SELECT getdept(&#39;0001ZZ10000000009UAL&#39;)) AND c_cwzt NOT IN (&#39;1&#39;, &#39;9&#39;) GROUP BY aj.c_id) table_count 问题 缺少外键索引 with 中的t_sacw_cwjbxx_copy不需要关联 没必要用with语句 求count(*)并且案件表left join xgr的子查询，因此数量没有变化。没必要连接。 对aj.c_id分组求max后取count(*),相当于对aj.c_id去重后求总数 t_sacw_cwjbxx_copy 仅为了传递连接，可以在t_sacw_cwfbxx_copy中冗余案件主表编号 现场数据库经历长时间更新删除等未及时进行VACUUM清理无效数据。引起表放大的问题。 列表查询求总数的SQL一定不要直接用查列表SQL套一个count(*) 修改后SQL 12345explain analyzeselect count(distinct aj.c_id) from db_yw.t_sacw_cwfbxx_copy fbxxJOIN db_yw.t_jc_gaaj aj ON fbxx.c_ajid &#x3D; aj.c_id WHERE fbxx.c_ysdw IN (SELECT getdept(&#39;0001ZZ10000000009UAL&#39;)) AND c_cwzt NOT IN (&#39;1&#39;, &#39;9&#39;) ; 3.2.2 前一个SQL对应的列表查询,提前缩小结果集大小案件列表查询，建议先查出符合条件的案件，然后再拼接xyr信息。 12345select aj.c_id C_AJID, MAX(aj.c_ajmc) C_AJMC, MAX(aj.c_ajbh) c_ajbh, MAX(aj.d_lasj) D_LARQ, MAX(fbxx.c_sydw) C_YSDW from db_yw.t_sacw_cwfbxx_copy fbxxJOIN db_yw.t_jc_gaaj aj ON fbxx.c_ajid &#x3D; aj.c_id WHERE fbxx.c_ysdw IN (SELECT getdept(&#39;0001ZZ10000000009UAL&#39;)) AND c_cwzt NOT IN (&#39;1&#39;, &#39;9&#39;) group by aj.c_id limit 20 一步从数据库获取包括嫌疑人的案件列表。提前通过限制条件及limit减小结果集大小，然后再关联xyr表进行分组拼接xyrxm。 123456789with aaj as (select aj.c_id C_AJID, MAX(aj.c_ajmc) C_AJMC, MAX(aj.c_ajbh) c_ajbh, MAX(aj.d_lasj) D_LARQ, MAX(fbxx.c_sydw) C_YSDW from db_yw.t_sacw_cwfbxx_copy fbxxJOIN db_yw.t_jc_gaaj aj ON fbxx.c_ajid &#x3D; aj.c_id WHERE fbxx.c_ysdw IN (SELECT getdept(&#39;0001ZZ10000000009UAL&#39;)) AND c_cwzt NOT IN (&#39;1&#39;, &#39;9&#39;) group by aj.c_id limit 20 )select aaj.C_AJID,max(aaj.C_AJMC),max(aaj.c_ajbh),max(aaj.D_LARQ),max(aaj.C_YSDW),string_agg((xyr.c_xyrxm), &#39;,&#39;) AS xyrxm from aaj join db_yw.t_jc_gaxyr xyr on aaj.C_AJID &#x3D; xyr.c_id_ajxxgroup by aaj.C_AJID 3.2.3体会一下pg对not exists的逻辑优化E:\\thunisoft\\arterybase\\3.6\\bin\\psql -Usa -h172.23.18.110 -p6543 -ddb_hjgl 1234567891011121314151617select * from ( select &#39;xk&#39; as type, s.c_ajmc as ajmc, s.c_bar as bar, r.c_xm as bkr, r.c_id as bkrid, &#39;实施边控&#39; cslxmc, s.c_id as id, to_char(s.dt_bkkhrq, &#39;yyyy-mm-dd&#39;) as skrq, s.c_bkbbbh as ykbbbh, to_char(s.dt_bkzkrq, &#39;yyyy-mm-dd&#39;) as zkrq from db_hjgl.t_ry r join db_hjgl.t_sq s on s.c_id &#x3D; r.c_sqid where (not exists(select 1 from db_hjgl.t_ykry y where r.c_id &#x3D; y.c_yryid) and not exists(select 1 from db_hjgl.t_ckry c where c.c_xkryid &#x3D; r.c_id and n_sfcxbk &#x3D; 1)) and s.dt_bkzkrq &gt; now() and s.n_sqzt &#x3D; 7 union select &#39;yk&#39; as type, s.c_ajmc as ajmc, s.c_bar as bar, r.c_xm as bkr, r.c_id as bkrid, &#39;延长边控&#39; cslxmc, s.c_id as id, to_char(s.dt_bkkhrq, &#39;yyyy-mm-dd&#39;) as skrq, s.c_bkbbbh as ykbbbh, to_char(s.dt_bkzkrq, &#39;yyyy-mm-dd&#39;) as zkrq from db_hjgl.t_ykry r join db_hjgl.t_sq s on s.c_id &#x3D; r.c_sqid where not exists(select 1 from db_hjgl.t_ckry c where c.c_ykryid &#x3D; r.c_id and n_sfcxbk &#x3D; 1) and not exists(select 1 from db_hjgl.t_ykry y where y.c_yryid &#x3D; r.c_id) and s.dt_bkzkrq &gt; now() and s.n_sqzt &#x3D; 7 )t WHERE 1 &#x3D; 1 order by t.skrq limit &#39;10&#39;::int offset (&#39;1&#39;::int - 1) * &#39;10&#39;::int 执行计划 123456789101112131415161718192021Nested Loop Anti Join (cost&#x3D;12.16..29.83 rows&#x3D;11 width&#x3D;232) (actual time&#x3D;0.172..0.250 rows&#x3D;15 loops&#x3D;1) Join Filter: (r.c_id &#x3D; (c.c_xkryid)::bpchar) Rows Removed by Join Filter: 15 -&gt; Hash Anti Join (cost&#x3D;12.16..18.23 rows&#x3D;11 width&#x3D;120) (actual time&#x3D;0.155..0.217 rows&#x3D;15 loops&#x3D;1) Hash Cond: (r.c_id &#x3D; y.c_yryid) -&gt; Hash Join (cost&#x3D;10.83..16.75 rows&#x3D;12 width&#x3D;120) (actual time&#x3D;0.125..0.182 rows&#x3D;24 loops&#x3D;1) Hash Cond: ((r.c_sqid)::bpchar &#x3D; s.c_id) -&gt; Seq Scan on t_ry r (cost&#x3D;0.00..5.31 rows&#x3D;131 width&#x3D;72) (actual time&#x3D;0.008..0.027 rows&#x3D;142 loops&#x3D;1) -&gt; Hash (cost&#x3D;10.59..10.59 rows&#x3D;19 width&#x3D;81) (actual time&#x3D;0.108..0.108 rows&#x3D;24 loops&#x3D;1) Buckets: 1024 Batches: 1 Memory Usage: 11kB -&gt; Seq Scan on t_sq s (cost&#x3D;0.00..10.59 rows&#x3D;19 width&#x3D;81) (actual time&#x3D;0.007..0.099 rows&#x3D;24 loops&#x3D;1) Filter: ((n_sqzt &#x3D; 7) AND (dt_bkzkrq &gt; now())) Rows Removed by Filter: 197 -&gt; Hash (cost&#x3D;1.15..1.15 rows&#x3D;15 width&#x3D;33) (actual time&#x3D;0.025..0.025 rows&#x3D;15 loops&#x3D;1) Buckets: 1024 Batches: 1 Memory Usage: 9kB -&gt; Seq Scan on t_ykry y (cost&#x3D;0.00..1.15 rows&#x3D;15 width&#x3D;33) (actual time&#x3D;0.004..0.022 rows&#x3D;15 loops&#x3D;1) -&gt; Materialize (cost&#x3D;0.00..11.38 rows&#x3D;1 width&#x3D;82) (actual time&#x3D;0.000..0.000 rows&#x3D;1 loops&#x3D;15) -&gt; Seq Scan on t_ckry c (cost&#x3D;0.00..11.38 rows&#x3D;1 width&#x3D;82) (actual time&#x3D;0.004..0.004 rows&#x3D;1 loops&#x3D;1) Filter: (n_sfcxbk &#x3D; 1)Planning time: 0.409 msExecution time: 0.324 ms join示意图 等价SQL 123456select &#39;xk&#39; as type, s.c_ajmc as ajmc, s.c_bar as bar, r.c_xm as bkr, r.c_id as bkrid, &#39;实施边控&#39; cslxmc, s.c_id as id, to_char(s.dt_bkkhrq, &#39;yyyy-mm-dd&#39;) as skrq, s.c_bkbbbh as ykbbbh, to_char(s.dt_bkzkrq, &#39;yyyy-mm-dd&#39;) as zkrq from db_hjgl.t_ry r join db_hjgl.t_sq s on s.c_id &#x3D; r.c_sqid left join db_hjgl.t_ykry y on r.c_id&#x3D;y.c_yryid left join db_hjgl.t_ckry c on r.c_id&#x3D;c.c_xkryid and c.n_sfcxbk&#x3D;1where y.c_yryid is null and c.c_xkryid is null and s.dt_bkzkrq &gt; now() and s.n_sqzt &#x3D; 7 3.3.4 其它部门的SQL1，利用with减少表扫描次数12345678910111213141516171819202122232425SELECT COUNT (DISTINCT(xfj.petition_no)) FROM ods_jzw.petition_basic_info xfj RIGHT JOIN ods_jzw.petition_deal_info deal ON xfj.oid &#x3D; deal.petition_basic_info_oid left join ods_jzw.t_xf_code as code on xfj.region_code &#x3D; code.c_code and code.c_pid &#x3D; &#39;XZQH&#39; WHERE deal.create_date&gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) AND deal.create_date&lt;to_timestamp(&#39;2019-04&#39;, &#39;yyyy-MM&#39;)UNION ALLSELECT COUNT (DISTINCT(xfj.petition_no)) FROM ods_jzw.petition_basic_info xfj RIGHT JOIN ods_jzw.petition_deal_info deal ON xfj.oid &#x3D; deal.petition_basic_info_oid left join ods_jzw.t_xf_code as code on xfj.region_code &#x3D; code.c_code and code.c_pid &#x3D; &#39;XZQH&#39; WHERE xfj.petition_class_code &#x3D; &#39;1&#39; AND deal.create_date&gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) AND deal.create_date&lt; to_timestamp(&#39;2019-04&#39;, &#39;yyyy-MM&#39;)UNION ALLSELECT COUNT (DISTINCT(xfj.petition_no)) FROM ods_jzw.petition_basic_info xfj RIGHT JOIN ods_jzw.petition_deal_info deal ON xfj.oid &#x3D; deal.petition_basic_info_oid left join ods_jzw.t_xf_code as code on xfj.region_code &#x3D; code.c_code and code.c_pid &#x3D; &#39;XZQH&#39; WHERE xfj.petition_class_code &#x3D; &#39;1&#39; AND xfj.repeat_flag !&#x3D; &#39;1&#39; AND deal.create_date&gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) AND deal.create_date&lt; to_timestamp(&#39;2019-04&#39;, &#39;yyyy-MM&#39;) 改写后SQL，速度提高1倍以上 1234567891011121314151617with xfj as ( select xfj.petition_no,xfj.petition_class_code,xfj.repeat_flag from ods_jzw.petition_basic_info xfj RIGHT JOIN ods_jzw.petition_deal_info dealON xfj.oid &#x3D; deal.petition_basic_info_oidleft join ods_jzw.t_xf_code as code on xfj.region_code &#x3D; code.c_code and code.c_pid &#x3D; &#39;XZQH&#39; WHERE deal.create_date&gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) AND deal.create_date&lt;to_timestamp(&#39;2019-04&#39;, &#39;yyyy-MM&#39;))SELECT COUNT (distinct xfj.petition_no) FROM xfjUNION ALLSELECT COUNT (DISTINCT(xfj.petition_no)) FROM xfj WHERE xfj.petition_class_code &#x3D; &#39;1&#39; UNION ALLSELECT COUNT (DISTINCT(xfj.petition_no)) FROM xfj WHERE xfj.petition_class_code &#x3D; &#39;1&#39; AND xfj.repeat_flag !&#x3D; &#39;1&#39; 3.3.5 其它部门的SQL1，超级长SQL123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as ddjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as ddjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code, 1, 4) in(&#39;0121&#39;,&#39;0122&#39;,&#39;0124&#39;,&#39;0123&#39;,&#39;0125&#39;,&#39;0126&#39;)) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code, 1, 4) in(&#39;0121&#39;,&#39;0122&#39;,&#39;0124&#39;,&#39;0123&#39;,&#39;0125&#39;,&#39;0126&#39;)) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code, 1, 4) in(&#39;0121&#39;,&#39;0122&#39;,&#39;0124&#39;,&#39;0123&#39;,&#39;0125&#39;,&#39;0126&#39;)) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code, 1, 4) in(&#39;0121&#39;,&#39;0122&#39;,&#39;0124&#39;,&#39;0123&#39;,&#39;0125&#39;,&#39;0126&#39;)) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as zzjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;501&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;501&#39; ) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;501&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;501&#39; ) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as zzjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0121&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0121&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0121&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0121&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as zjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;565&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;565&#39; ) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;565&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;565&#39; ) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as zjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0122&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0122&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0122&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0122&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as ljjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;610&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;610&#39; ) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;610&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;610&#39; ) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as ljjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0123&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0123&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0123&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0123&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as qzjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;672&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;672&#39; ) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;672&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;672&#39; ) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as qzjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0124&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0124&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0124&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0124&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as gzjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;692&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;692&#39; ) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;692&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;692&#39; ) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as gzjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0125&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0125&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0125&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0125&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT thhxbj.bj1 + cbhsbj.bj2 + ajslbj.bj3 + qtbj.bj4 as shjlbj FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj1 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;725&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND thhx.bh &#x3D; wjwf.c_ajbh AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj2 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;725&#39; ) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND cbhs.bh &#x3D; wjwf.c_ajbh AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhsbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj3 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;725&#39; ) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE ajsl.bh &#x3D; wjwf.c_ajbh AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslbj, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as bj4 FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;1&#39; and c_fltl &#x3D;&#39;jlcf2018&#39; and c_wjyjfl &#x3D; &#39;725&#39; ) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.c_ajbh &#x3D; wtxs.c_bh )as qtbjunion all SELECT thhxsl.sl1 + cbhssl.sl2 + ajslsl.sl3 + qtsl.sl4 as shjlsl FROM (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl1 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0126&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_thhx_jl WHERE c_clfs in (&#39;1&#39;,&#39;2&#39;,&#39;3&#39;,&#39;4&#39;,&#39;5&#39;))as thhxjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_thhx WHERE d_jsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as thhx WHERE thhx.bh &#x3D; thhxjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND thhx.c_ajbs &#x3D; wtxs.c_ajbs )as thhxsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl2 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0126&#39;) as wjwf, (SELECT DISTINCT(c_ajbh)as ajbh FROM ods_zhba.t_zhba_cbhs_cbhsqk WHERE c_clfs in (&#39;1&#39;,&#39;3&#39;,&#39;4&#39;))as cbhsjl, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_cbhs WHERE d_chjsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_chjsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as cbhs, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs WHERE cbhs.bh &#x3D; cbhsjl.ajbh AND wtxs.c_xfbh &#x3D; wjwf.petition_no AND cbhs.c_ajbs &#x3D; wtxs.c_ajbs )as cbhssl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl3 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0126&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh as bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_sljsrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_sljsrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;))as ajsl WHERE wtxs.c_xfbh &#x3D; wjwf.petition_no AND ajsl.c_ajbs &#x3D; wtxs.c_ajbs )as ajslsl, (SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as sl4 FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0126&#39;) as wjwf, (SELECT c_bh,c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39; and c_pchhczfs in(&#39;5&#39;,&#39;27&#39;,&#39;32&#39;) AND d_flrq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_flrq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as wtxs WHERE wjwf.petition_no &#x3D; wtxs.c_xfbh )as qtslunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as fzbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as fzsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4) in(&#39;0141&#39;,&#39;0148&#39;,&#39;0144&#39;,&#39;0145&#39;,&#39;0146&#39;,&#39;0147&#39;)) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as twhlbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39; and c_wjyjfl &#x3D; &#39;1&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;) ) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as twhlsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0141&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as lyzqbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39; and c_wjyjfl &#x3D; &#39;19&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;) ) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as lyzqsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0148&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as whzsbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39; and c_wjyjfl &#x3D; &#39;35&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;) ) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as whzssl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0144&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as xswbbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39; and c_wjyjfl &#x3D; &#39;47&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;) ) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as xswbsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0145&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as zrsgbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39; and c_wjyjfl &#x3D; &#39;63&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;) ) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as zrsgsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0146&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as fzqtbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl &#x3D; &#39;xf&#39; and c_wjyjfl &#x3D; &#39;75&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;) ) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as fzqtsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4)&#x3D;&#39;0147&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt;to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_nounion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as qtbj FROM (SELECT c_ajbh FROM ods_zhba.t_zhba_wjwf WHERE c_lx &#x3D; &#39;2&#39; and c_fltl in (&#39;gwyf&#39;,&#39;fgf&#39;,&#39;jcgf&#39;,&#39;byzcf&#39;)) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_bh,c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND ajsl.c_bh &#x3D; wjwf.c_ajbhunion all SELECT COALESCE(COUNT(DISTINCT(wtxs.c_xfbh)),0) as qtsl FROM (SELECT petition_no FROM ods_jzw.issue_type_info WHERE substr(issue_type_code,1,4) &#x3D;&#39;0151&#39;) as wjwf, (SELECT c_xfbh,c_ajbs FROM ods_zhba.t_zhba_wtxs WHERE c_xfly &#x3D; &#39;1&#39;) as wtxs, (SELECT c_ajbs FROM ods_zhba.t_zhba_ajsl WHERE d_jarq &gt;&#x3D; to_timestamp(&#39;2018-04&#39;, &#39;yyyy-MM&#39;) and d_jarq &lt; to_timestamp(&#39;2019-03&#39;, &#39;yyyy-MM&#39;)) as ajsl WHERE ajsl.c_ajbs &#x3D; wtxs.c_ajbs AND wtxs.c_xfbh &#x3D; wjwf.petition_no 解决方法创建表达式索引 1create index i_issue_type_info_code14 on ods_jzw.issue_type_info(substr(issue_type_code, 1, 4)) 四、总结4.1索引部分影响使用索引的因素 能否走索引，是操作符是否被对应的索引访问方法支持来决定的。 是否用索引是优化器决定的，如果走索引的成本低，可以走索引。或者使用了开关，禁止全表扫(大幅度增加全表扫描的代价，并不是真的禁用)，也可以走索引。 常见不走索引的情况 数据类型不匹配 where子句进行表达式或函数操作 like的全模糊匹配(btree) 数据占比 长时间未进行表分析(vacuum analyze)，统计信息不准确 强调一下公司规范 所有逻辑外键需创建索引 多级子表应该包含所有上级表的主键 （如主表&lt;-子表关系：A&lt;-B&lt;-C，C要有B、A的逻辑外键，以此类推） 表连接join条件用到的字段必须类型相同，避免隐式转换造成索引失效 书写规范禁用select * 4.2 其他对性能的影响，设计〉SQL优化〉参数优化，设计阶段就要考虑性能。减少查询联表的数量，简单的使用数据库。SQL优化意识比技术更重要。","categories":[],"tags":[{"name":"SQL优化","slug":"SQL优化","permalink":"http://blog.loveyx815.cn/tags/SQL%E4%BC%98%E5%8C%96/"}]}],"categories":[],"tags":[{"name":"SQL优化","slug":"SQL优化","permalink":"http://blog.loveyx815.cn/tags/SQL%E4%BC%98%E5%8C%96/"}]}